# Feature Specification: タスク管理アプリ（Task Management）

**Feature Branch**: `1-task-management`  
**Created**: 2025-11-16  
**Status**: Draft  
**Input**: User description: "タスク管理アプリを作成したい。主要機能を以下に示す。①タスクのCRUD②サブタスク③タスクへのタグ付与およびタグの管理④各種ダッシュボード（期限切れのタスク/期限が近いタスク/すべてのタスク）"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - タスクの基本操作（Priority: P1）

ユーザーはタスクを作成、参照、更新、削除（CRUD）できる。各タスクはタイトル、説明、期限、優先度、状態（未着手/進行中/完了）を持つ。

**Why this priority**: 基本的なタスク管理機能はアプリケーションの核であり、最優先で提供する必要があるため。

**Independent Test**: 新規タスクを追加 → タスク一覧に表示 → タスク編集でフィールドを更新 → タスクが更新される → タスク削除で一覧から消える。

**Acceptance Scenarios**:
1. **Given** 空のタスクリスト、 **When** ユーザーが必須フィールドでタスクを作成、 **Then** 作成したタスクが一覧に表示される。
2. **Given** 既存タスク、 **When** ユーザーがタスクを編集して保存、 **Then** 表示内容が更新される。
3. **Given** 既存タスク、 **When** ユーザーがタスクを削除、 **Then** タスクは一覧から削除される。

---

### User Story 2 - サブタスク（Priority: P1）

ユーザーはタスクに対して複数のサブタスクを追加できる。サブタスクは独立して完了状態を持ち、親タスクの進捗に反映される（例: サブタスク全完了で親を完了にするかどうかは実装ポリシーとして選択可能）。

**Why this priority**: 複雑な作業を分割して管理するための重要機能である。

**Independent Test**: 親タスクを作成 → サブタスクを追加 → サブタスクの状態を切替 → 親タスクの進捗/表示が適切に反映される。

**Acceptance Scenarios**:
1. **Given** 親タスクが存在、 **When** サブタスクを追加、 **Then** サブタスクが親タスクの下に表示される。
2. **Given** 複数のサブタスク、 **When** すべてのサブタスクが完了、 **Then** 親タスクに完了フラグ（または視覚的な完了表示）が付与される（挙動はAssumptions参照）。

---

### User Story 3 - タグとタグ管理（Priority: P2）

ユーザーはタスクに複数のタグを付与できる。タグは一覧で管理（作成・編集・削除）でき、タグでタスクをフィルタできる。

**Why this priority**: タスクの分類とフィルタリングでユーザーの生産性を向上させるため。

**Independent Test**: タグを作成 → タスクにタグを追加 → タグで一覧をフィルタ → フィルタ結果が期待通りになる。

**Acceptance Scenarios**:
1. **Given** タグが未作成、 **When** 新規タグを作成、 **Then** タグ一覧に追加される。
2. **Given** タスクにタグを追加、 **When** タグでフィルタ、 **Then** 当該タグを持つタスクのみ表示される。

---

### User Story 4 - ダッシュボード（Priority: P2）

ユーザーは以下のダッシュボードビューを参照できる: 期限切れのタスク、期限が近いタスク（例: 7日以内）、すべてのタスク。

**Why this priority**: タスクの優先度付けと管理のために視認性が重要である。

**Independent Test**: 複数タスクを作成（期限を設定）→ 各ダッシュボードを表示 → 表示に含まれるタスクが条件に合致する。

**Acceptance Scenarios**:
1. **Given** 期限が過ぎたタスクが存在、 **When** 「期限切れ」ビューを表示、 **Then** 期限切れタスクのみ表示される。
2. **Given** 期限が近いタスクが存在、 **When** 「期限が近い」ビューを表示、 **Then** 期間内のタスクのみ表示される。

---

### Edge Cases

- 期限のないタスクの扱い（一覧のどこに表示するか）。
- サブタスク大量追加時の表示・並び順。
- 同名タグの重複管理（同名を禁止するか、内部IDで区別するか）。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムはユーザーがタスクを作成、参照、更新、削除（CRUD）できること。
- **FR-002**: タスクはタイトル（必須）、説明（任意）、期限（任意）、優先度（任意）、状態（列挙値）を持つこと。
- **FR-003**: システムはタスクに対して複数のサブタスクを紐づけられること。サブタスクは独立して状態を持つ。
- **FR-004**: システムはタグを管理（作成・編集・削除）でき、タスクに複数タグを付与できること。
- **FR-005**: システムはタグによるフィルタリング機能を提供すること。
- **FR-006**: システムは期限切れ、期限が近い、すべてのタスクを表示するダッシュボードを提供すること。
- **FR-007**: すべての主要機能は独立してテスト可能であること（受入基準を満たすエンドツーエンドのシナリオを持つ）。

## Key Entities *(include if feature involves data)*

- **Task**: id, title, description, due_date, priority, status, tags[], parent_task_id?（親タスクの参照）
- **Subtask**: id, title, status, parent_task_id
- **Tag**: id, name, color?（表示用）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: P1 フロー（タスクCRUD + サブタスク基本操作）が手動テストで再現可能で、主要シナリオの受入テストが100%合格すること。
- **SC-002**: ダッシュボード（期限切れ/期限が近い/すべて）が手動テストで検証可能で、表示の条件一致率が100%であること。
- **SC-003**: タグによるフィルタで期待するタスクが90%以上正しく返ること（データ前提に依存するため、明確な受入テストを定義すること）。
- **SC-004**: ユーザーが主要なタスク操作を3分以内に完了できる（UI 操作性の目標、実測による検証）。

## Assumptions

- 単一テナントのタスク管理（最初は認証・多ユーザーの詳細は省略）。
- データの永続化は存在するものとするが、実装手段は本仕様では記述しない。
- 親タスクの「自動完了」ポリシーはチームで決める（デフォルトでは自動完了は行わない。要望があればオプションで提供）。

## Dependencies

- UI/UX の要件確定（表示/操作の詳細が未指定）
- 要件に応じたデータ永続化・バックエンド設計

## Notes

- 重大な未決点: マルチユーザー/共有タスク、通知やリマインダー機能は本フェーズに含めていない。必要なら別機能として追加する。

